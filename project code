data <- fread("https://github.com/simransharma1114/bus462grouproject/blob/7481b6b242b9cd385dbc5d6702fb55b6a49823f8/credit%20data.csv")
colSums(is.na(data))
data <- na.omit(data)

#Change data type of variables to integers

data$credit_history <- as.integer(factor(data$credit_history, levels = c("'critical/other existing credit'", "'existing paid'",  "'delayed previously'", "'no credits/all paid'" ,"'all paid'" )))
data$purpose <- as.integer(factor(data$purpose, levels = c("radio/tv","education","furniture/equipment","'new car'","'used car'","business","'domestic appliance'","repairs","other","retraining")))
data$property_magnitude <- as.integer(factor(data$property_magnitude, levels = c("'real estate'","'life insurance'","'no known property'","car")))
data$housing<- as.integer(factor(data$housing, levels = c("own", "'for free'","rent")))
data$own_telephone<- as.integer(factor(data$own_telephone, levels = c("yes","none")))

#Q1 - What variables should be focused on while evaluating credit amount?


#Q2 - How does the scale of purchases affect oneâ€™s credit amount? That is, are individuals more likely to pay off their credit or less likely when purchasing larger items (which may take longer to pay off)?
#Dependent Variable: Credit Amount
#Independent Variables: Purpose, Credit History, Duration, Property Magnitude, Housing, Telephone (assuming it is similar to a mobile device and will be quite expensive)

require(data.table)
library(PerformanceAnalytics)
library(stargazer)

dataq2<-subset(data,select=c(purpose, credit_history,duration,property_magnitude,housing,own_telephone,credit_amount))
dataframeq2<-data.frame(dataq2)
dataframeq2

#To get the correlation chart of all variables.
chart.Correlation(dataframeq2, histogram=TRUE, pch=19)

#run the OLS model
OLSModel <- lm(dataframeq2$credit_amount ~ dataframeq2$purpose + dataframeq2$credit_history + dataframeq2$duration + dataframeq2$property_magnitude + dataframeq2$housing + dataframeq2$own_telephone, data=dataframeq2)
OLSModel

#OLS Model 2 (considers interaction between credit history and duration)
historyduration <- (dataq2$credit_history*dataq2$duration)
OLSModel2 <- lm(dataframeq2$credit_amount ~ dataframeq2$purpose + dataframeq2$property_magnitude + dataframeq2$housing + dataframeq2$own_telephone + historyduration, data=dataframeq2)
OLSModel2
summary(OLSModel2)
stargazer(OLSModel2,type="text")
AIC(OLSModel2)

# Let's look at the summary results from the OLS regression model
summary(OLSModel)
stargazer(OLSModel,type="text")
AIC(OLSModel)



#Q3 - Given the loan/customer features, we want to predict the default on loans.
